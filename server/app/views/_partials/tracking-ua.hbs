{{#unless queryParams.noexternals}}
	<script>
		// Create initial ga() function and set initial execution time
		// This code is based on code from Google that shows one how to include UA Tracking.
		window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;

		// Load UA async and flag $script when ready (used by Ember initializer)
		$script(['{{server.gaUrl}}'], 'ua');

		$.getJSON('/wikia.php', {
			controller: 'MercuryApi',
			method: 'getTrackingDimensions',
			title: M.prop('displayTitle'),
			format: 'json'
		}, function(data) {
				if (data && data.dimensions) {
					let dimensions = [];
					$.each(data.dimensions, (index, value) => dimensions[index] = value);

					// when everything loads, initialize trackers and track initial pageview
					$script.ready(['optimizely'], function() {
						var ua = M.tracker.UniversalAnalytics;

						ua.initialize(dimensions);
						ua.trackPageView();
					});
				}
		});
	</script>
{{else}}
	<script>$script.done('ua');</script>
{{/unless}}
